<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å ´æ¬¡æŸ¥è©¢çµæœ - å¨ç§€å½±åŸ</title>
    
    <!-- å¼•å…¥ Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        // ç¢ºä¿ Tailwind é…ç½®èˆ‡ index.html ä¸€è‡´
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        // å¨ç§€ä¸»é¡Œè‰²ï¼šç´…è‰²å’Œé‡‘è‰²
                        'vieshow-red': '#e50914',
                        'vieshow-gold': '#f7a83d',
                    },
                    fontFamily: {
                        sans: ['Inter', 'Noto Sans TC', 'sans-serif'],
                    },
                }
            }
        }
    </script>
    
    <style>
        /* ä½¿ç”¨ Inter å’Œ Noto Sans TC ç¢ºä¿ä¸­è‹±æ–‡å­—é«”é¡¯ç¤ºæ­£å¸¸ */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&family=Noto+Sans+TC:wght@100..900&display=swap');
        body {
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
        }

        /* å ´æ¬¡æ™‚é–“æŒ‰éˆ•æ¨£å¼ */
        .showtime-button {
            @apply px-4 py-2 bg-white text-gray-800 border border-gray-300 rounded-full font-semibold transition duration-200 ease-in-out;
        }
        .showtime-button:hover {
            @apply bg-vieshow-red text-white border-vieshow-red shadow-md transform scale-105;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans min-h-screen flex flex-col">

    <!-- Header å°èˆªæ¬„ (èˆ‡ index.html ä¿æŒä¸€è‡´) -->
    <header class="bg-gray-800 text-white shadow-md">
        <nav class="container mx-auto px-4 py-4 flex justify-between items-center">
            <a href="../../index.html" class="text-xl font-bold hover:text-vieshow-red transition duration-300">Vieshow å½±åŸ</a>
            <div class="space-x-4">
                <a href="../auth/login.html" class="hover:text-vieshow-gold transition duration-300">ç™»å…¥</a>
                <a href="../member/member_home.html" class="hover:text-vieshow-gold transition duration-300">æœƒå“¡ä¸­å¿ƒ</a>
            </div>
        </nav>
    </header>

    <main class="container mx-auto px-4 py-8 flex-grow">
        
        <div class="bg-white p-8 rounded-xl shadow-xl mb-10">
            <h1 class="text-3xl sm:text-4xl font-extrabold text-gray-900 mb-2 border-l-4 border-vieshow-gold pl-4">
                ğŸ¥ ä»Šæ—¥å ´æ¬¡æŸ¥è©¢çµæœ
            </h1>
            <!-- æŸ¥è©¢æ¢ä»¶é¡¯ç¤ºå€ -->
            <div id="search-criteria" class="text-lg text-gray-600 mb-6 flex flex-wrap gap-4 mt-4">
                <!-- æŸ¥è©¢æ¢ä»¶å°‡ç”± JS å¡«å…… -->
            </div>
            <a href="../../index.html" class="text-vieshow-red hover:text-red-700 font-semibold transition duration-300 flex items-center">
                <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-1" viewBox="0 0 20 20" fill="currentColor">
                    <path fill-rule="evenodd" d="M9.707 16.707a1 1 0 01-1.414 0l-6-6a1 1 0 010-1.414l6-6a1 1 0 011.414 1.414L5.414 9H17a1 1 0 110 2H5.414l4.293 4.293a1 1 0 010 1.414z" clip-rule="evenodd" />
                </svg>
                è¿”å›é‡æ–°æŸ¥è©¢
            </a>
        </div>

        <!-- å ´æ¬¡åˆ—è¡¨å€å¡Š -->
        <div id="showtimes-list" class="space-y-8">
            <!-- å ´æ¬¡è³‡è¨Šå°‡ç”± JS è¼‰å…¥ -->
        </div>

    </main>

    <!-- Footer é è…³ (èˆ‡ index.html ä¿æŒä¸€è‡´) -->
    <footer class="bg-gray-800 text-white text-center py-4 mt-8 shadow-inner">
        <p>&copy; 2025 Vieshow Ticketing System</p>
    </footer>

    <!-- JavaScript é‚è¼¯ï¼šç²å–åƒæ•¸ä¸¦æ¸²æŸ“å ´æ¬¡ -->
    <script>
        // æ¨¡æ“¬é›»å½±å ´æ¬¡è³‡æ–™ (çœŸå¯¦æ‡‰ç”¨ä¸­æœƒå¾å¾Œç«¯ç²å–)
        const mockShowtimes = [
            { id: 'M001', name: "æ˜Ÿéš›ç‰¹æ”»éšŠï¼šç„¡é™æˆ°çˆ­", format: "IMAX 2D", rating: "ä¿è­·ç´š", times: ["10:00", "13:30", "17:00", "20:30"], duration: 150 },
            { id: 'M002', name: "å¤¢æƒ³å•Ÿå‹•ï¼šäººå·¥æ™ºæ…§æ™‚ä»£", format: "æ•¸ä½ 2D", rating: "æ™®éç´š", times: ["11:00", "14:45", "18:30"], duration: 120 },
            { id: 'M003', name: "æ¥µé€Ÿç‹‚é£†ï¼šåˆå¤œå°æ±º", format: "æ•¸ä½ 4DX", rating: "é™åˆ¶ç´š", times: ["12:15", "15:45", "19:15", "22:45"], duration: 135 },
            { id: 'M004', name: "è²“å’ªåµæ¢èˆ‡å¤±è¹¤çš„é‘½çŸ³", format: "æ•¸ä½ 3D", rating: "æ™®éç´š", times: ["09:30", "13:00", "16:30"], duration: 95 },
            { id: 'M005', name: "å¤±è½çš„å¤æ–‡æ˜", format: "æ•¸ä½ 2D", rating: "ä¿è­·ç´š", times: ["10:45", "14:15", "17:45"], duration: 140 },
        ];

        // åœ°é»ä»£ç¢¼å°æ‡‰åç¨±
        const locationMap = {
            'taipei': 'å°åŒ—ä¿¡ç¾©å¨ç§€å½±åŸ',
            'taichung': 'å°ä¸­å¤§é ç™¾å¨ç§€å½±åŸ',
            'kaohsiung': 'é«˜é›„å¤§é ç™¾å¨ç§€å½±åŸ'
        };

        document.addEventListener('DOMContentLoaded', () => {
            const params = new URLSearchParams(window.location.search);
            const locationCode = params.get('location');
            const date = params.get('date');

            if (!locationCode || !date) {
                document.getElementById('search-criteria').innerHTML = '<p class="text-red-600">âš ï¸ æ‰¾ä¸åˆ°æŸ¥è©¢åƒæ•¸ã€‚è«‹è¿”å›é¦–é é‡æ–°æŸ¥è©¢ã€‚</p>';
                return;
            }

            const locationName = locationMap[locationCode] || 'æœªçŸ¥å½±åŸ';
            
            // é¡¯ç¤ºæŸ¥è©¢æ¢ä»¶
            document.getElementById('search-criteria').innerHTML = `
                <span class="bg-vieshow-red/10 text-vieshow-red font-bold p-2 rounded-lg">å½±åŸåœ°é»: ${locationName}</span>
                <span class="bg-gray-200 text-gray-800 font-bold p-2 rounded-lg">æ—¥æœŸ: ${date}</span>
            `;

            renderShowtimes(mockShowtimes, locationName);
        });

        /**
         * æ¸²æŸ“é›»å½±å ´æ¬¡åˆ—è¡¨
         * @param {Array<object>} showtimes - å ´æ¬¡è³‡æ–™é™£åˆ—
         * @param {string} locationName - å½±åŸåç¨±
         */
        function renderShowtimes(showtimes, locationName) {
            const container = document.getElementById('showtimes-list');
            if (!container) return;

            const html = showtimes.map(movie => `
                <div class="bg-white p-6 rounded-xl shadow-lg border-t-2 border-vieshow-red/50">
                    <div class="md:flex md:justify-between md:items-start mb-4">
                        <!-- é›»å½±æ¨™é¡Œèˆ‡è³‡è¨Š -->
                        <div>
                            <h2 class="text-2xl font-extrabold text-gray-900 hover:text-vieshow-red transition duration-300">
                                <a href="../movie/movie_info.html?movie_id=${movie.id}">${movie.name}</a>
                            </h2>
                            <p class="text-sm text-gray-500 mt-1">
                                ç‰‡é•·: ${movie.duration} åˆ†é˜ |
                                <span class="font-semibold text-gray-700">${movie.format}</span> |
                                <span class="text-vieshow-red font-semibold">${movie.rating}</span>
                            </p>
                        </div>
                    </div>

                    <!-- å ´æ¬¡æ™‚é–“æŒ‰éˆ•åˆ—è¡¨ -->
                    <div class="mt-4 border-t pt-4 border-gray-200">
                        <h3 class="text-lg font-semibold text-gray-700 mb-3">å ´æ¬¡æ™‚é–“ (${locationName})ï¼š</h3>
                        <div class="flex flex-wrap gap-3">
                            ${movie.times.map(time => `
                                <!-- é»æ“Šå ´æ¬¡æ™‚é–“æœƒè·³è½‰åˆ°é¸ä½é é¢ (seat_selection.html) -->
                                <button onclick="selectShowtime('${movie.id}', '${movie.name}', '${time}')" 
                                        class="showtime-button">
                                    ${time}
                                </button>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `).join('');

            container.innerHTML = html;
        }

        /**
         * æ¨¡æ“¬é¸å®šå ´æ¬¡ä¸¦è·³è½‰åˆ°é¸ä½é é¢
         * @param {string} movieId 
         * @param {string} movieName 
         * @param {string} time 
         */
        function selectShowtime(movieId, movieName, time) {
            // åœ¨é€™è£¡å¯ä»¥åŠ å…¥æ›´å¤šçš„åƒæ•¸ï¼Œä¾‹å¦‚æ—¥æœŸã€å½±åŸ ID ç­‰
            const date = new URLSearchParams(window.location.search).get('date');
            const locationCode = new URLSearchParams(window.location.search).get('location');

            // å¯¦éš›æ‡‰å°èˆªè‡³é¸ä½é é¢
            // ä¾‹å¦‚ï¼šwindow.location.href = `../booking/seat_selection.html?movie_id=${movieId}&time=${time}&date=${date}&loc=${locationCode}`;
            
            // é€™è£¡å…ˆä½¿ç”¨æ¨¡æ“¬æç¤º
            console.log(`æ‚¨é¸æ“‡äº†: ${movieName}, æ™‚é–“: ${time}`);
            alert(`å·²é¸æ“‡ ${movieName} (${time})ã€‚æ¥ä¸‹ä¾†å°‡é€²å…¥é¸ä½é é¢ã€‚`);
        }
        
        /**
         * æ¨¡æ“¬ alert() å‡½æ•¸ï¼Œé¿å…ç€è¦½å™¨å½ˆå‡ºæ¡†
         * @param {string} message - è¨Šæ¯å…§å®¹
         */
        function alert(message) {
            const existingModal = document.getElementById('custom-alert-modal');
            if (existingModal) existingModal.remove();

            const modalHtml = `
                <div id="custom-alert-modal" class="fixed inset-0 bg-gray-900 bg-opacity-75 flex items-center justify-center p-4 z-50">
                    <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-sm transform scale-100 transition-all duration-300">
                        <div class="text-xl font-bold text-gray-900 mb-3 flex items-center">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 text-vieshow-red mr-2" viewBox="0 0 20 20" fill="currentColor">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7 4a1 1 0 11-2 0 1 1 0 012 0zm-1-9a1 1 0 00-1 1v4a1 1 0 102 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                            </svg>
                            ç³»çµ±æç¤º
                        </div>
                        <p class="text-gray-700 mb-5">${message}</p>
                        <div class="flex justify-end">
                            <button onclick="document.getElementById('custom-alert-modal').remove()" 
                                    class="bg-vieshow-red hover:bg-red-700 text-white font-semibold py-2 px-4 rounded-lg transition duration-200 focus:outline-none focus:ring-2 focus:ring-vieshow-red focus:ring-offset-2">
                                ç¢ºèª
                            </button>
                        </div>
                    </div>
                </div>
            `;
            document.body.insertAdjacentHTML('beforeend', modalHtml);
        }
    </script>
</body>
</html>