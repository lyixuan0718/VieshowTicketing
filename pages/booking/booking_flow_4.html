<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¨‚ç¥¨æ­¥é©Ÿ 4: è¨‚å–®ç¢ºèª - Vieshow Ticketing</title> 
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
    </style>

</head>
<body class="antialiased">

<!-- Header -->
<header class="bg-gray-800 text-white shadow-md">
    <nav class="container mx-auto px-4 py-4 flex justify-between items-center">
        <a href="../../index.html" class="text-xl font-bold hover:text-red-400 transition">Vieshow å½±åŸ</a>
        <div class="space-x-4">
            <a href="../auth/login.html" class="hover:text-yellow-300 transition">ç™»å…¥</a>
            <a href="../member/member_home.html" class="hover:text-yellow-300 transition">æœƒå“¡ä¸­å¿ƒ</a>
        </div>
    </nav>
</header>

<!-- ä¸»å®¹å™¨ï¼ˆå¥—ç”¨ Step3 çš„ç‰ˆé¢ï¼‰ -->
<div class="w-11/12 md:max-w-2xl mx-auto my-8 p-6 bg-white border border-gray-200 rounded-xl shadow-2xl">

    <h2 class="text-2xl font-extrabold text-gray-900 mb-6 flex items-center">
        âœ… è¨‚ç¥¨æµç¨‹ - æ­¥é©Ÿ 4/7 (è¨‚å–®ç¢ºèª)
    </h2>

    <p class="text-gray-700 mb-4">
        è«‹ä»”ç´°æ ¸å°æ‚¨çš„è¨‚å–®å…§å®¹ï¼Œè¨‚å–®å»ºç«‹å¾Œå³ <span class="text-red-600 font-bold">ç„¡æ³•ä¿®æ”¹åº§ä½</span>ã€‚
    </p>

    <!-- è¨‚å–®è©³æƒ…æ¨™é¡Œ -->
    <h3 class="text-xl font-semibold border-b-2 border-red-600 pb-2 mt-6 mb-4 text-red-700">
        è¨‚å–®è©³æƒ…
    </h3>

    <!-- è¨‚å–®æ‘˜è¦ -->
    <div class="bg-gray-50 p-4 rounded-lg mb-6 text-sm md:text-base border border-gray-100">
        <p>å½±åŸï¼š<strong id="cinemaName">è¼‰å…¥ä¸­...</strong></p>
        <p>é›»å½±ï¼š<strong id="movieTitle">è¼‰å…¥ä¸­...</strong></p>
        <p>å ´æ¬¡ï¼š<strong id="showtimeDetails">è¼‰å…¥ä¸­...</strong></p>
        <p>åº§ä½ï¼š<strong id="selectedSeatsList">è¼‰å…¥ä¸­...</strong></p>

        <div class="border-t my-3"></div>

        <h4 class="text-lg font-semibold text-gray-800">ğŸ« é›»å½±ç¥¨</h4>
        <div id="ticketsSummary" class="mt-1 text-gray-700">è¼‰å…¥ä¸­...</div>

        <div class="border-t my-3"></div>

        <h4 class="text-lg font-semibold text-gray-800">ğŸ¿ é¤é»</h4>
        <div id="foodSummary" class="mt-1 text-gray-700">è¼‰å…¥ä¸­...</div>

        <div class="border-t my-3"></div>

        <p class="text-lg font-bold">
            æ‡‰ä»˜ç¸½é‡‘é¡ï¼š<span class="text-red-600 text-2xl">NT$ <span id="totalPriceDisplay">0</span></span>
        </p>
    </div>

   <!-- å°èˆªæŒ‰éˆ• -->
    <div class="flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4 mb-4">
        <a href="booking_flow_3.html" class="flex-1 text-center bg-gray-500 hover:bg-gray-700 text-white font-bold py-3 px-4 rounded-xl transition duration-300 shadow-lg text-base">
            <!-- Icon: Arrow Left -->
            <svg class="w-5 h-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg> 
            é‡æ–°é¸æ“‡åº§ä½ (æ­¥é©Ÿ 3)
        </a>
        <button type="submit" id="nextStepButton" class="next-step-button flex-1" disabled style="border: 2px solid #333; border-radius: 6px;">
            ä¸‹ä¸€æ­¥: é¸æ“‡ä»˜æ¬¾æ–¹å¼ (æ­¥é©Ÿ 5)
        </button>
    </div>
</div>

<!-- JavaScriptï¼ˆåŸæ¨£ä¿ç•™ï¼‰ -->
<script>
    const cinemaNameDisplay = document.getElementById("cinemaName");
    const movieTitleDisplay = document.getElementById("movieTitle");
    const showtimeDetailDisplay = document.getElementById("showtimeDetails");
    const selectedSeatsList = document.getElementById("selectedSeatsList");
    const ticketsSummary = document.getElementById("ticketsSummary");
    const foodSummary = document.getElementById("foodSummary");
    const totalPriceDisplay = document.getElementById("totalPriceDisplay");
    const nextStepButton = document.getElementById('nextStepButton');

    let currentBooking = {};

    function loadOrderData() {
        const storedData = localStorage.getItem('currentBooking');
        if (storedData) {
            try {
                currentBooking = JSON.parse(storedData);
            } catch (e) {
                console.error(e);
                currentBooking = {};
            }
        }

        cinemaNameDisplay.textContent = currentBooking.cinemaName || "è¼‰å…¥ä¸­...";
        movieTitleDisplay.textContent = currentBooking.movieTitle || "è¼‰å…¥ä¸­...";
        showtimeDetailDisplay.textContent = currentBooking.showtimeDetail || "è¼‰å…¥ä¸­...";
        selectedSeatsList.textContent = currentBooking.selectedSeats ? currentBooking.selectedSeats.join(', ') : "è¼‰å…¥ä¸­...";
        totalPriceDisplay.textContent = currentBooking.totalPrice || "0";

        // ç¥¨ç¨®æ‘˜è¦
        const tickets = currentBooking.tickets || {};
        const ticketEntries = Object.values(tickets);
        ticketsSummary.textContent = ticketEntries.length
            ? "ç¥¨ç¨®èˆ‡æ•¸é‡ï¼š" + ticketEntries.map(t => `${t.name} x ${t.qty}`).join(" + ")
            : "ç¥¨ç¨®èˆ‡æ•¸é‡ï¼šç„¡";

        // é¤é»æ‘˜è¦
        const combos = currentBooking.combos || {};
        const comboEntries = Object.values(combos);
        foodSummary.textContent = comboEntries.length
            ? "é¤é»ï¼š" + comboEntries.map(c => `${c.name} x ${c.qty}`).join(" + ")
            : "é¤é»ï¼šç„¡";

        nextStepButton.disabled = false; // è¼‰å…¥å®Œæˆå¾Œå•Ÿç”¨æŒ‰éˆ•
    }

    nextStepButton.addEventListener('click', function() {
        window.location.href = 'booking_flow_5.html';
    });

    loadOrderData();

</script>

<!-- Footer -->
<footer class="bg-gray-800 text-white text-center py-4 mt-8 shadow-inner">
    <p>&copy; 2025 Vieshow Ticketing System</p>
</footer>

</body>
</html>
