<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- æ¨™é¡Œæ›´æ–°ç‚ºæ­¥é©Ÿ 2 -->
    <title>è¨‚ç¥¨æ­¥é©Ÿ 2: é¸æ“‡ç¥¨ç¨®èˆ‡é¤é» - Vieshow Ticketing</title> 
    
    <!-- å¼•å…¥ Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script>
        // Tailwind é…ç½®ï¼Œç¢ºä¿é¡è‰²å’Œå­—é«”èˆ‡å°ˆæ¡ˆä¸€è‡´
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'vieshow-red': '#e50914',
                        'vieshow-gold': '#f7a83d',
                    },
                    fontFamily: {
                        sans: ['Inter', 'Noto Sans TC', 'sans-serif'],
                    },
                },
            },
        };
    </script>
    
    <style>
        /* åŸºç¤æ¨£å¼ï¼šæ²¿ç”¨ Step 1 çš„é¢¨æ ¼ */
        .select-styled {
            @apply w-full p-3 bg-white border border-gray-300 rounded-lg shadow-sm
                   focus:outline-none focus:ring-2 focus:ring-vieshow-gold focus:border-vieshow-gold;
        }
        /* ä¸‹ä¸€æ­¥æŒ‰éˆ•çš„ Vieshow ç´…è‰²é¢¨æ ¼ */
        .next-step-button {
            @apply w-full bg-vieshow-red hover:bg-red-700 text-white font-bold py-3 px-4 rounded-xl 
                   transition duration-300 shadow-lg text-lg disabled:opacity-50 disabled:cursor-not-allowed;
        }
        /* é¸é …å¡ç‰‡çš„é¢¨æ ¼ */
        .selection-card {
            @apply border p-4 rounded-xl bg-white shadow-md transition duration-300 hover:shadow-lg;
        }
        /* åƒ¹æ ¼æ¨™ç±¤çš„é¢¨æ ¼ */
        .price-tag {
            @apply text-lg font-bold text-vieshow-red;
        }
        /* è¼¸å…¥æ¡†é¢¨æ ¼ */
        .quantity-input {
            @apply w-16 text-center border border-gray-300 rounded-lg p-2 focus:ring-vieshow-gold focus:border-vieshow-gold;
        }
        /* ç‚ºäº†è®“ç¸½è¨ˆå€å¡Šå›ºå®šåœ¨åº•éƒ¨ï¼Œéœ€è¦ç¢ºä¿å®¹å™¨å¯æ»¾å‹• */
        #bookingCard {
            position: relative;
            padding-bottom: 7rem; /* ç•™çµ¦ sticky footer çš„ç©ºé–“ */
        }
        #totalSummaryFooter {
            position: sticky;
            bottom: 0;
            z-index: 10;
        }
    </style>
</head>
<body class="bg-gray-100 font-sans min-h-screen flex flex-col">
    
    <!-- Header å°èˆª (æ²¿ç”¨ Step 1) -->
    <header class="bg-gray-800 text-white shadow-md">
        <nav class="container mx-auto px-4 py-4 flex justify-between items-center">
            <a href="../../index.html" class="text-xl font-bold hover:text-vieshow-red transition duration-300">Vieshow å½±åŸ</a>
            <div class="space-x-4">
                <a href="../auth/login.html" class="hover:text-vieshow-gold transition duration-300">ç™»å…¥</a>
                <a href="../member/member_home.html" class="hover:text-vieshow-gold transition duration-300">æœƒå“¡ä¸­å¿ƒ</a>
            </div>
        </nav>
    </header>

    <div class="container mx-auto px-4 py-8 flex-grow max-w-2xl">
        
        <!-- ä¸»è¦è¨‚ç¥¨å¡ç‰‡ -->
        <div id="bookingCard" class="bg-white p-6 md:p-10 rounded-xl shadow-2xl border-t-4 border-vieshow-red">
            
            <!-- æ­¥é©ŸæŒ‡ç¤ºå™¨ (æ›´æ–°ç‚ºæ­¥é©Ÿ 2) -->
            <div class="mb-8 pb-4 border-b border-gray-200">
                <h1 class="text-3xl font-extrabold text-gray-900 mb-2">ğŸŸï¸ è¨‚ç¥¨æµç¨‹</h1>
                <p class="text-xl font-semibold text-vieshow-red">æ­¥é©Ÿ 2/7: é¸æ“‡ç¥¨ç¨®èˆ‡é¤é»</p>
                <p class="text-sm text-gray-500 mt-1">è«‹é¸æ“‡æ‚¨éœ€è¦çš„ç¥¨ç¨®æ•¸é‡èˆ‡åŠ è³¼é¤é»ã€‚</p>
            </div>

            <!-- 1. å·²é¸æ“‡å ´æ¬¡æ‘˜è¦ (å¾ Step 1 è¼‰å…¥) -->
            <div id="summarySection" class="p-4 rounded-xl bg-vieshow-gold/10 border-l-4 border-vieshow-gold text-sm text-gray-700 mb-6 shadow-inner">
                <h2 class="font-bold text-lg mb-2 text-gray-800 flex items-center">
                    <!-- Icon: Information Circle -->
                    <svg class="w-5 h-5 mr-2 text-vieshow-gold" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path></svg>
                    å ´æ¬¡ç¢ºèª
                </h2>
                <div id="cinemaNameDisplay">å½±åŸ: è¼‰å…¥ä¸­...</div>
                <div id="movieTitleDisplay">é›»å½±: è¼‰å…¥ä¸­...</div>
                <div id="showtimeDetailDisplay" class="font-mono mt-1 text-gray-900 font-semibold">å ´æ¬¡: è¼‰å…¥ä¸­...</div>
                <div id="loadError" class="text-red-600 font-semibold hidden mt-2">è¼‰å…¥è³‡æ–™å¤±æ•—ï¼Œè«‹å›ä¸Šä¸€æ­¥ã€‚</div>
            </div>

            <!-- Step 2 è¡¨å–®å…§å®¹ -->
            <form id="bookingFlow2Form" action="#" method="POST" class="space-y-8">
                
                <!-- 2. é¸æ“‡ç¥¨ç¨®æ•¸é‡ (Select Ticket Quantity) -->
                <div id="ticketSelectionSection" class="space-y-4">
                    <label class="block text-2xl font-bold text-gray-800 mb-4 border-b pb-2">é¸æ“‡ç¥¨ç¨®æ•¸é‡ <span class="text-base font-normal text-red-500">(æœ€å¤š 8 å¼µ)</span></label>
                    <!-- Ticket options will be dynamically inserted here by JavaScript -->
                </div>
                
                <!-- 3. é¸æ“‡é¤é»åŠ è³¼ (Combo Add-ons) -->
                <div id="comboSelectionSection" class="space-y-4">
                    <label class="block text-2xl font-bold text-gray-800 mb-4 border-b pb-2">é¤é»åŠ è³¼ (å¯é¸)</label>
                    <!-- Combo options will be dynamically inserted here by JavaScript -->
                </div>
                
                <!-- ç¸½è¨ˆå€å¡Š + å°èˆªæŒ‰éˆ• (å›ºå®šåœ¨åº•éƒ¨) -->
                <div id="totalSummaryFooter" class="bg-white pt-4 -mx-10 px-10 border-t border-gray-200 shadow-2xl">
                    <div class="bg-gray-800 text-white p-4 rounded-xl shadow-2xl font-extrabold text-center text-base mb-4">
                        ç¸½è¨ˆé‡‘é¡: <span id="totalPrice">$0 TWD</span>
                    </div>

                    <!-- å°èˆªæŒ‰éˆ• -->
                    <div class="flex flex-col md:flex-row space-y-4 md:space-y-0 md:space-x-4 mb-4">
                        <a href="booking_flow_1.html" class="flex-1 text-center bg-gray-500 hover:bg-gray-700 text-white font-bold py-3 px-4 rounded-xl transition duration-300 shadow-lg text-base">
                            <!-- Icon: Arrow Left -->
                            <svg class="w-5 h-5 inline-block mr-1" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 19l-7-7m0 0l7-7m-7 7h18"></path></svg> 
                            é‡æ–°é¸æ“‡å ´æ¬¡ (æ­¥é©Ÿ 1)
                        </a>
                        <button type="submit" id="nextStepButton" class="next-step-button flex-1" disabled style="border: 2px solid #333; border-radius: 6px;">
                            ä¸‹ä¸€æ­¥: é¸æ“‡åº§ä½ (æ­¥é©Ÿ 3)
                        </button>
                    </div>
                </div>

            </form>
        </div>
    </div>

    <!-- é é¢å°ˆå±¬çš„ JavaScript é‚è¼¯ï¼šè™•ç†ç¥¨ç¨®èˆ‡é¤é»é¸æ“‡ -->
    <script>
        // Mock Data for Step 2
        const MOCK_TICKETS = [
            { id: 'full', name: 'å…¨ç¥¨', price: 320, limit: 8, description: 'ä¸€èˆ¬æˆäººç¥¨' },
            { id: 'student', name: 'å­¸ç”Ÿç¥¨', price: 280, limit: 4, description: 'æ†‘æœ‰æ•ˆå­¸ç”Ÿè­‰å…¥å ´' },
            { id: 'elder', name: 'æ„›å¿ƒæ•¬è€ç¥¨', price: 160, limit: 2, description: '65æ­²ä»¥ä¸Šé•·è€…æˆ–èº«å¿ƒéšœç¤™è€…' },
        ];

        const MOCK_COMBOS = [
            { id: 'combo_a', name: 'ç¶“å…¸çˆ†ç±³èŠ±å¥—é¤', price: 150, description: 'Mçˆ†ç±³èŠ± + ä¸­å¯æ¨‚ x1' },
            { id: 'combo_b', name: 'é›™äººè±ªè¯å¥—é¤', price: 300, description: 'Lçˆ†ç±³èŠ± + å¤§å¯æ¨‚ x2 + ç†±ç‹— x1' },
            { id: 'combo_c', name: 'å–®äººé£²å“åŠ è³¼', price: 80, description: 'å¤§æ¯å¯æ¨‚ x1' },
        ];
        
        // æœ€å¤§ç¸½ç¥¨æ•¸é™åˆ¶
        const MAX_TICKETS = 8;
        
        // å–å¾— DOM å…ƒç´ 
        const cinemaNameDisplay = document.getElementById('cinemaNameDisplay');
        const movieTitleDisplay = document.getElementById('movieTitleDisplay');
        const showtimeDetailDisplay = document.getElementById('showtimeDetailDisplay');
        const loadError = document.getElementById('loadError');
        const ticketSelectionSection = document.getElementById('ticketSelectionSection');
        const comboSelectionSection = document.getElementById('comboSelectionSection');
        const totalPriceDisplay = document.getElementById('totalPrice');
        const nextStepButton = document.getElementById('nextStepButton');
        const form = document.getElementById('bookingFlow2Form');

        // å„²å­˜ç•¶å‰é¸æ“‡çš„æ•¸é‡
        let currentSelections = {
            tickets: {}, // { full: 0, student: 0, ... }
            combos: {}   // { combo_a: 0, combo_b: 0, ... }
        };

        let currentBookingData = null; // å„²å­˜æ­¥é©Ÿ 1 çš„è³‡æ–™


        // 1. è¼‰å…¥æ­¥é©Ÿ 1 çš„è³‡æ–™ä¸¦é¡¯ç¤º
        function loadBookingData() {
            const data = localStorage.getItem('currentBooking');
            if (data) {
                try {
                    currentBookingData = JSON.parse(data);
                    cinemaNameDisplay.textContent = `å½±åŸ: ${currentBookingData.cinemaName || 'æœªé¸æ“‡'}`;
                    movieTitleDisplay.textContent = `é›»å½±: ${currentBookingData.movieTitle || 'æœªé¸æ“‡'}`;
                    showtimeDetailDisplay.textContent = `å ´æ¬¡: ${currentBookingData.showtimeDetail || 'æœªé¸æ“‡'}`;
                } catch (e) {
                    console.error('è§£ææ­¥é©Ÿ 1 è³‡æ–™å¤±æ•—:', e);
                    loadError.classList.remove('hidden');
                }
            } else {
                console.warn('æ‰¾ä¸åˆ°æ­¥é©Ÿ 1 çš„è¨‚ç¥¨è³‡æ–™ã€‚ä½¿ç”¨é è¨­å€¼ã€‚');
                cinemaNameDisplay.textContent = `å½±åŸ: å¨ç§€å½±åŸ (æ¨¡æ“¬)`;
                movieTitleDisplay.textContent = `é›»å½±: æ²™ä¸˜ï¼šç¬¬äºŒéƒ¨`;
                showtimeDetailDisplay.textContent = `å ´æ¬¡: 2025/11/17 (ä¸€) 19:30 - æ•¸ä½ 3 å»³`;
                currentBookingData = {
                    cinemaName: 'å¨ç§€å½±åŸ (æ¨¡æ“¬)',
                    movieTitle: 'æ²™ä¸˜ï¼šç¬¬äºŒéƒ¨',
                    showtimeDetail: '2025/11/17 (ä¸€) 19:30 - æ•¸ä½ 3 å»³'
                };
            }
        }

        // 2. æ¸²æŸ“ç¥¨ç¨®é¸æ“‡ UI
        function renderTicketOptions() {
            // æ¸…ç©ºä¸¦é‡æ–°åŠ å…¥æ¨™é¡Œ
            let html = `<label class="block text-2xl font-bold text-gray-800 mb-4 border-b pb-2">é¸æ“‡ç¥¨ç¨®æ•¸é‡ <span class="text-base font-normal text-red-500">(æœ€å¤š ${MAX_TICKETS} å¼µ)</span></label>`;
            
            html += MOCK_TICKETS.map(ticket => `
                <div class="selection-card flex justify-between items-center mb-4">
                    <div class="flex-1">
                        <div class="text-base font-semibold text-gray-900">${ticket.name}</div>
                        <p class="text-base text-gray-500">${ticket.description} (${ticket.limit ? `å–®ç¨®ä¸Šé™: ${ticket.limit} å¼µ` : 'ç„¡ä¸Šé™'})</p>
                        <span class="price-tag mt-1">TWD ${ticket.price.toLocaleString('en-US')}</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <!-- æ¸›è™ŸæŒ‰éˆ• -->
                        <button type="button" class="btn-minus bg-gray-200 p-2 rounded-full hover:bg-gray-300 transition duration-150 active:scale-95" data-id="${ticket.id}" data-type="ticket">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path></svg>
                        </button>
                        <!-- æ•¸é‡è¼¸å…¥æ¡† (åªè®€) -->
                        <input type="number" id="ticket-${ticket.id}" name="ticket-${ticket.id}" 
                               class="quantity-input" value="0" min="0" max="${ticket.limit}" readonly 
                               data-id="${ticket.id}" data-type="ticket">
                        <!-- åŠ è™ŸæŒ‰éˆ• -->
                        <button type="button" class="btn-plus bg-vieshow-red text-white p-2 rounded-full hover:bg-red-700 transition duration-150 active:scale-95" data-id="${ticket.id}" data-type="ticket">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                        </button>
                    </div>
                </div>
            `).join('');
            
            ticketSelectionSection.innerHTML = html;
            
            // åˆå§‹åŒ– currentSelections.tickets
            MOCK_TICKETS.forEach(t => currentSelections.tickets[t.id] = 0);
            
            // ç¶å®šäº‹ä»¶ç›£è½å™¨
            ticketSelectionSection.addEventListener('click', handleQuantityChange);
        }

        // 3. æ¸²æŸ“é¤é»é¸æ“‡ UI
        function renderComboOptions() {
            // æ¸…ç©ºä¸¦é‡æ–°åŠ å…¥æ¨™é¡Œ
            let html = `<label class="block text-2xl font-bold text-gray-800 mb-4 border-b pb-2">é¤é»åŠ è³¼ (å¯é¸)</label>`;

            html += MOCK_COMBOS.map(combo => `
                <div class="selection-card flex justify-between items-center mb-4">
                    <div class="flex-1">
                        <div class="text-base font-semibold text-gray-900">${combo.name}</div>
                        <p class="text-base text-gray-500">${combo.description}</p>
                        <span class="price-tag mt-1">TWD ${combo.price.toLocaleString('en-US')}</span>
                    </div>
                    <div class="flex items-center space-x-2">
                        <!-- æ¸›è™ŸæŒ‰éˆ• -->
                        <button type="button" class="btn-minus bg-gray-200 p-2 rounded-full hover:bg-gray-300 transition duration-150 active:scale-95" data-id="${combo.id}" data-type="combo">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path></svg>
                        </button>
                        <!-- æ•¸é‡è¼¸å…¥æ¡† (åªè®€) -->
                        <input type="number" id="combo-${combo.id}" name="combo-${combo.id}" 
                               class="quantity-input" value="0" min="0" max="99" readonly
                               data-id="${combo.id}" data-type="combo">
                        <!-- åŠ è™ŸæŒ‰éˆ• -->
                        <button type="button" class="btn-plus bg-vieshow-red text-white p-2 rounded-full hover:bg-red-700 transition duration-150 active:scale-95" data-id="${combo.id}" data-type="combo">
                            <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 4v16m8-8H4"></path></svg>
                        </button>
                    </div>
                </div>
            `).join('');
            
            comboSelectionSection.innerHTML = html;
            
            // åˆå§‹åŒ– currentSelections.combos
            MOCK_COMBOS.forEach(c => currentSelections.combos[c.id] = 0);
            
            // ç¶å®šäº‹ä»¶ç›£è½å™¨
            comboSelectionSection.addEventListener('click', handleQuantityChange);
        }
        
        // 4. è™•ç†æ•¸é‡å¢æ¸›é‚è¼¯
        function handleQuantityChange(event) {
            const target = event.target.closest('button');
            if (!target) return;
            
            const itemId = target.getAttribute('data-id');
            const itemType = target.getAttribute('data-type');
            const inputElement = document.getElementById(`${itemType}-${itemId}`);
            
            if (!inputElement) return;

            let currentValue = parseInt(inputElement.value);
            let newValue = currentValue;
            
            const isPlus = target.classList.contains('btn-plus');

            if (itemType === 'ticket') {
                const ticketInfo = MOCK_TICKETS.find(t => t.id === itemId);
                
                // è¨ˆç®—ç›®å‰æ‰€æœ‰ç¥¨ç¨®çš„ç¸½å’Œ (ä¸åŒ…æ‹¬ç•¶å‰æ­£åœ¨æ“ä½œçš„ç¥¨ç¨®)
                let ticketTotal = Object.values(currentSelections.tickets).reduce((sum, count) => sum + count, 0);
                // æ’é™¤ç•¶å‰ç¥¨ç¨®çš„è¨ˆæ•¸ï¼Œå› ç‚ºæˆ‘å€‘æ¥ä¸‹ä¾†æœƒæ›´æ–°å®ƒ
                ticketTotal -= currentValue;

                if (isPlus) {
                    // æª¢æŸ¥å–®ä¸€ç¥¨ç¨®ä¸Šé™
                    if (currentValue >= ticketInfo.limit) return; 
                    // æª¢æŸ¥ç¸½ç¥¨æ•¸ä¸Šé™
                    if ((ticketTotal + 1) > MAX_TICKETS) {
                         // é€™è£¡å¯ä»¥åŠ ä¸Šä¸€å€‹ Modal æç¤ºï¼Œä½†é¿å…ä½¿ç”¨ alert
                         console.error(`ç¸½ç¥¨æ•¸å·²é”ä¸Šé™ ${MAX_TICKETS} å¼µ!`);
                         return;
                    } 
                    newValue++;
                } else {
                    if (currentValue > 0) newValue--;
                }
                
                currentSelections.tickets[itemId] = newValue;

            } else if (itemType === 'combo') {
                // é¤é»æ•¸é‡æ§åˆ¶ (ç„¡ç¸½ä¸Šé™ï¼Œä½†ä¸èƒ½å°æ–¼ 0)
                if (isPlus) {
                    newValue++;
                } else {
                    if (currentValue > 0) newValue--;
                }
                currentSelections.combos[itemId] = newValue;
            }

            inputElement.value = newValue;
            updateTotal();
            checkFormValidity();
        }

        // 5. è¨ˆç®—ä¸¦æ›´æ–°ç¸½é‡‘é¡
        function updateTotal() {
            let total = 0;
            let ticketCount = 0;

            // è¨ˆç®—ç¥¨åƒ¹ç¸½å’Œ
            MOCK_TICKETS.forEach(ticket => {
                const count = currentSelections.tickets[ticket.id] || 0;
                total += count * ticket.price;
                ticketCount += count;
            });

            // è¨ˆç®—é¤é»ç¸½å’Œ
            MOCK_COMBOS.forEach(combo => {
                const count = currentSelections.combos[combo.id] || 0;
                total += count * combo.price;
            });

            totalPriceDisplay.textContent = `$${total.toLocaleString('en-US')} TWD`;
            return ticketCount;
        }

        // 6. æª¢æŸ¥è¡¨å–®æœ‰æ•ˆæ€§ (è‡³å°‘é¸æ“‡ä¸€å¼µç¥¨)
        function checkFormValidity() {
            const totalTickets = updateTotal();
            if (totalTickets > 0) {
                nextStepButton.disabled = false;
            } else {
                nextStepButton.disabled = true;
            }
        }

        // 7. ç›£è½å™¨ï¼šè¡¨å–®æäº¤ (ä¸‹ä¸€æ­¥)
        form.addEventListener('submit', function(event) {
    event.preventDefault();

    const totalTickets = Object.values(currentSelections.tickets).reduce((s, c) => s + c, 0);
    if (totalTickets === 0) {
        console.error("è«‹è‡³å°‘é¸æ“‡ä¸€å¼µç¥¨ï¼");
        return;
    }

    // æ•´ç†ç¥¨ç¨®
    const ticketData = {};
    let ticketPriceTotal = 0;

    MOCK_TICKETS.forEach(t => {
        const qty = currentSelections.tickets[t.id];
        if (qty > 0) {
            ticketData[t.id] = {
                name: t.name,
                price: t.price,
                qty: qty,
                subtotal: qty * t.price
            };
            ticketPriceTotal += qty * t.price;
        }
    });

    // æ•´ç†é¤é»
    const comboData = {};
    let comboPriceTotal = 0;

    MOCK_COMBOS.forEach(c => {
        const qty = currentSelections.combos[c.id];
        if (qty > 0) {
            comboData[c.id] = {
                name: c.name,
                price: c.price,
                qty: qty,
                subtotal: qty * c.price
            };
            comboPriceTotal += qty * c.price;
        }
    });

    const finalPrice = ticketPriceTotal + comboPriceTotal;

    // è®€å–ç¾æœ‰ Step1 è³‡æ–™
    const base = currentBookingData || {};

    // å„²å­˜ Step2 è³‡æ–™ï¼ˆå…¨çµ±ä¸€æ ¼å¼ï¼‰
    const step2Data = {
        ...base,

        tickets: ticketData,
        combos: comboData,

        totalTicketQty: totalTickets,
        totalTicketPrice: ticketPriceTotal,

        totalComboPrice: comboPriceTotal,
        totalPrice: finalPrice
    };

    localStorage.setItem('currentBooking', JSON.stringify(step2Data));

    console.log("ğŸ”¥ Step2 å·²å„²å­˜ï¼š", step2Data);

    window.location.href = "booking_flow_3.html";
});

        // é é¢è¼‰å…¥æ™‚ï¼ŒåŸ·è¡Œåˆå§‹åŒ–
        window.onload = function() {
            loadBookingData();
            renderTicketOptions();
            renderComboOptions();
            checkFormValidity(); // åˆå§‹åŒ–æ™‚æª¢æŸ¥æŒ‰éˆ•ç‹€æ…‹
        };
    </script>


    <!-- Footer å…§å®¹ (æ²¿ç”¨ Step 1) -->
    <footer class="bg-gray-800 text-white text-center py-4 mt-8 shadow-inner">
        <p>&copy; 2025 Vieshow Ticketing System</p>
    </footer>
    
</body>
</html>